---
import ImageMod from "@/components/ImageMod.astro";
import Base from "@/layouts/Base.astro";
import { getListPage } from "@/lib/contentParser.astro";
import { markdownify } from "@/lib/utils/textConverter";
import { render } from "astro:content";

const publicationsIndex = await getListPage("publications", "-index");
const { Content } = await render(publicationsIndex);
const { title, description, meta_title, image } = publicationsIndex.data;

if (publicationsIndex.data.draft) {
  return Astro.redirect("/404");
}

// Publication data - we'll extract this from markdown for better styling
const publications = [
  {
    title: "Mitigate Account Takeovers with Datadog App and API Protection",
    url: "https://www.datadoghq.com/blog/mitigate-account-takeovers/",
    date: "April 28, 2025",
    coAuthor: "Océane Bordeau",
    description: "This comprehensive guide explores how organizations can detect, respond to, and prevent account takeover (ATO) attacks using Datadog's App and API Protection platform. The article covers automated detection of suspicious login activities, real-time security signals, and flexible response strategies including IP blocking and WAF rule customization.",
    topics: [
      "Account takeover attack patterns and risks",
      "Automated detection through login endpoint instrumentation", 
      "Real-time security signal generation and analysis",
      "Multi-layered response strategies and prevention techniques"
    ]
  },
  {
    title: "Detect and respond to evolving attacks with Attacker Clustering",
    url: "https://www.datadoghq.com/blog/attacker-clustering/",
    date: "February 26, 2025", 
    coAuthor: "Océane Bordeau",
    description: "This article introduces Datadog's new Attacker Clustering feature in App and API Protection (AAP), which helps security teams detect and respond to distributed attacks. The piece explores how the clustering mechanism groups attacker behaviors by analyzing patterns in attributes like user agents and attacker fingerprints, enabling security teams to track evolving attack strategies and streamline incident response.",
    topics: [
      "Advanced threat detection through behavioral clustering",
      "Adapting to evolving attacker strategies",
      "Streamlined incident response workflows", 
      "Pattern recognition for distributed attacks"
    ]
  }
];
---

<Base
  title={title}
  meta_title={meta_title}
  description={description}
  image={image}
>
  <!-- Hero Section -->
  <section class="section-sm bg-gradient-to-r from-primary/5 to-secondary/5">
    <div class="container">
      <div class="row justify-center">
        <div class="text-center lg:col-8">
          <h1 set:html={markdownify(title)} class="h1 mb-4" />
          <p class="text-lg text-text/80 mb-8">
            Technical articles and research on AI-powered security, software engineering, and technology leadership
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Publications Grid -->
  <section class="section">
    <div class="container">
      <div class="row justify-center">
        <div class="lg:col-10">
          <div class="mb-12">
            <h2 class="h3 mb-8 text-center">Recent Publications</h2>
            <div class="grid gap-8 lg:gap-12">
              {publications.map((article, index) => (
                <article class="group relative overflow-hidden rounded-2xl border border-border/50 bg-white p-8 shadow-sm transition-all duration-300 hover:shadow-xl hover:shadow-primary/5 dark:bg-theme-light dark:shadow-dark">
                  <!-- Article Header -->
                  <div class="mb-6">
                    <div class="mb-4 flex flex-wrap items-center gap-3 text-sm text-text/60">
                      <span class="rounded-full bg-primary/10 px-3 py-1 text-primary">Datadog Blog</span>
                      <time class="font-medium">{article.date}</time>
                      {article.coAuthor && (
                        <span class="italic">Co-authored with {article.coAuthor}</span>
                      )}
                    </div>
                    <h3 class="group-hover:text-primary transition-colors duration-200">
                      <a 
                        href={article.url}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="text-xl font-bold leading-tight lg:text-2xl"
                      >
                        {article.title}
                      </a>
                    </h3>
                  </div>

                  <!-- Article Content -->
                  <div class="mb-6">
                    <p class="text-text/80 leading-relaxed mb-6">
                      {article.description}
                    </p>
                    
                    <!-- Topics -->
                    <div class="mb-6">
                      <h4 class="font-semibold text-sm uppercase tracking-wide text-text/70 mb-3">
                        Key Topics Covered
                      </h4>
                      <div class="grid gap-2 sm:grid-cols-2">
                        {article.topics.map((topic) => (
                          <div class="flex items-start gap-2">
                            <div class="mt-2 h-1.5 w-1.5 rounded-full bg-primary flex-shrink-0"></div>
                            <span class="text-sm text-text/70">{topic}</span>
                          </div>
                        ))}
                      </div>
                    </div>
                  </div>

                  <!-- Call to Action -->
                  <div class="flex items-center justify-between">
                    <a 
                      href={article.url}
                      target="_blank"
                      rel="noopener noreferrer"
                      class="inline-flex items-center gap-2 font-semibold text-primary transition-all hover:gap-3 hover:text-primary/80"
                    >
                      Read Full Article
                      <svg class="h-4 w-4 transition-transform group-hover:translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                      </svg>
                    </a>
                    <div class="text-xs text-text/50">
                      #{String(index + 1).padStart(2, '0')}
                    </div>
                  </div>

                  <!-- Decorative Element -->
                  <div class="absolute -right-6 -top-6 h-24 w-24 rounded-full bg-gradient-to-br from-primary/10 to-secondary/10 opacity-0 transition-opacity duration-300 group-hover:opacity-100"></div>
                </article>
              ))}
            </div>
          </div>

          <!-- Coming Soon Section -->
          <div class="text-center">
            <div class="inline-flex items-center gap-3 rounded-xl border border-dashed border-border/50 bg-theme-light/50 px-6 py-4">
              <div class="h-2 w-2 animate-pulse rounded-full bg-primary"></div>
              <span class="text-sm font-medium text-text/70">
                Additional articles and publications will be added as they become available
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</Base>