---
import ImageMod from "@/components/ImageMod.astro";
import Base from "@/layouts/Base.astro";
import { getListPage } from "@/lib/contentParser.astro";
import { markdownify } from "@/lib/utils/textConverter";
import { render } from "astro:content";

const aboutIndex = await getListPage("about", "-index");
const { Content } = await render(aboutIndex);
const { title, description, meta_title, image } = aboutIndex.data;

if (aboutIndex.data.draft) {
  return Astro.redirect("/404");
}

// Experience data
const experiences = [
  {
    id: "datadog-lead",
    title: "Senior Software Engineer / Tech Lead",
    company: "Datadog",
    companyLogo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/datadog/datadog-original.svg",
    period: "2024 - Present",
    location: "Paris, France",
    achievements: [
      "Built a system that groups attackers by behavior to help security teams spot patterns",
      "Mentored junior engineers and helped them grow into security experts",
      "Improved how we detect API endpoints using statistical methods (made it way more accurate)",
      "Extended our AI security analyst to catch more types of attacks",
      "Led the team building AI Guard - think of it as a bouncer for AI applications"
    ],
    technologies: ["Go", "Python", "Kubernetes", "PostgreSQL", "Machine Learning"]
  },
  {
    id: "datadog-eng",
    title: "Software Engineer II",
    company: "Datadog",
    companyLogo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/datadog/datadog-original.svg",
    period: "2022 - 2024",
    location: "Paris, France",
    achievements: [
      "Built key features that help developers secure their applications",
      "Made our attack detection smarter - especially for attacks spread across multiple systems",
      "Created automated responses that kick in when we detect threats",
      "Worked on systems that share threat intelligence in real-time across teams"
    ],
    technologies: ["Go", "Java", "Docker", "Kafka", "Terraform"]
  },
  {
    id: "amadeus",
    title: "Software Engineer",
    company: "Amadeus",
    companyLogo: "/images/amadeus.png",
    period: "2019 - 2022",
    location: "Nice, France",
    achievements: [
      "Built ML models that helped predict flight prices and optimize bookings",
      "Led a team of 10 engineers as Scrum Master (learned a lot about herding cats!)",
      "Created data pipelines that fed our machine learning models with clean training data", 
      "Made booking algorithms smarter, which meant happier customers and better conversion rates"
    ],
    technologies: ["Scala", "Apache Spark", "TensorFlow", "Apache Airflow", "SQL"]
  }
];

// All skills with logos - flattened for card display
const allSkills = [
  // Programming Languages
  { 
    name: "Go", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/go/go-original.svg",
    category: "Programming Languages"
  },
  { 
    name: "Java", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/java/java-original.svg",
    category: "Programming Languages"
  },
  { 
    name: "Python", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/python/python-original.svg",
    category: "Programming Languages"
  },
  { 
    name: "Scala", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/scala/scala-original.svg",
    category: "Programming Languages"
  },
  { 
    name: "TypeScript", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/typescript/typescript-original.svg",
    category: "Programming Languages"
  },
  
  // Backend Frameworks
  { 
    name: "Flask", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/flask/flask-original.svg",
    category: "Backend"
  },
  { 
    name: "FastAPI", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/fastapi/fastapi-original.svg",
    category: "Backend"
  },
  { 
    name: "Django", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/django/django-plain.svg",
    category: "Backend"
  },
  
  // Frontend
  { 
    name: "React", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/react/react-original.svg",
    category: "Frontend"
  },
  
  // Data & ML
  { 
    name: "Apache Spark", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/apachespark/apachespark-original.svg",
    category: "Data & ML"
  },
  { 
    name: "TensorFlow", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/tensorflow/tensorflow-original.svg",
    category: "Data & ML"
  },
  { 
    name: "PyTorch", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/pytorch/pytorch-original.svg",
    category: "Data & ML"
  },
  { 
    name: "Apache Kafka", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/apachekafka/apachekafka-original.svg",
    category: "Data & ML"
  },
  { 
    name: "Apache Airflow", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/apache/apache-original.svg",
    category: "Data & ML"
  },
  
  // Cloud & Infrastructure
  { 
    name: "Docker", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/docker/docker-original.svg",
    category: "Infrastructure"
  },
  { 
    name: "Kubernetes", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/kubernetes/kubernetes-plain.svg",
    category: "Infrastructure"
  },
  { 
    name: "Terraform", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/terraform/terraform-original.svg",
    category: "Infrastructure"
  },
  { 
    name: "Prometheus", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/prometheus/prometheus-original.svg",
    category: "Infrastructure"
  },
  { 
    name: "Grafana", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/grafana/grafana-original.svg",
    category: "Infrastructure"
  },
  
  // Databases
  { 
    name: "PostgreSQL", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/postgresql/postgresql-original.svg",
    category: "Databases"
  },
  { 
    name: "MongoDB", 
    logo: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/mongodb/mongodb-original.svg",
    category: "Databases"
  }
];
---

<Base
  title={title}
  meta_title={meta_title}
  description={description}
  image={image}
>
  <!-- Hero Section -->
  <section class="section-sm bg-gradient-to-br from-primary/5 via-transparent to-secondary/5">
    <div class="container">
      <div class="row items-center">
        <div class="lg:col-8">
          <div class="mb-8 lg:mb-0">
            <h1 class="h1 mb-4 text-dark dark:text-white">Emmanuelle Lejeail</h1>
            <h2 class="h4 mb-6 text-primary dark:text-white">Senior Software Engineer & Tech Lead</h2>
            <p class="text-lg text-text/80 mb-8 leading-relaxed">
              I love building software that makes the internet safer. I work with AI and machine learning to create tools that help catch attackers and protect applications from getting compromised.
            </p>
            <div class="flex flex-wrap gap-4">
              <a 
                href="https://www.linkedin.com/in/emmanuelle-lejeail/" 
                target="_blank"
                rel="noopener noreferrer"
                class="btn btn-primary inline-flex items-center justify-center"
              >
                <svg class="mr-2 h-4 w-4 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M16.338 16.338H13.67V12.16c0-.995-.017-2.277-1.387-2.277-1.39 0-1.601 1.086-1.601 2.207v4.248H8.014v-8.59h2.559v1.174h.037c.356-.675 1.227-1.387 2.526-1.387 2.703 0 3.203 1.778 3.203 4.092v4.711zM5.005 6.575a1.548 1.548 0 11-.003-3.096 1.548 1.548 0 01.003 3.096zm-1.337 9.763H6.34v-8.59H3.667v8.59zM17.668 1H2.328C1.595 1 1 1.581 1 2.298v15.403C1 18.418 1.595 19 2.328 19h15.34c.734 0 1.332-.582 1.332-1.299V2.298C19 1.581 18.402 1 17.668 1z" clip-rule="evenodd" />
                </svg>
                <span>LinkedIn</span>
              </a>
              <a 
                href="https://github.com/emmlejeail" 
                target="_blank"
                rel="noopener noreferrer"
                class="btn btn-outline-primary inline-flex items-center justify-center"
              >
                <svg class="mr-2 h-4 w-4 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 0C4.477 0 0 4.484 0 10.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0110 4.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.203 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.942.359.31.678.921.678 1.856 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0020 10.017C20 4.484 15.522 0 10 0z" clip-rule="evenodd" />
                </svg>
                <span>GitHub</span>
              </a>
              <a 
                href="/publications"
                class="btn btn-outline-primary inline-flex items-center justify-center"
              >
                <span class="mr-2 text-base flex-shrink-0">üìù</span>
                <span>Writing</span>
              </a>
            </div>
          </div>
        </div>
        <div class="lg:col-4">
          <div class="text-center">
            {
              image && (
                <ImageMod
                  class="mx-auto rounded-2xl shadow-lg"
                  src={image}
                  width={300}
                  height={300}
                  alt={title}
                  format="webp"
                />
              )
            }
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Experience Section -->
  <section class="section-sm">
    <div class="container">
      <div class="row">
        <div class="lg:col-12">
          <h2 class="h2 mb-8 text-center">Professional Experience</h2>
          <div class="space-y-8">
            {experiences.map((exp, index) => (
              <div class="group relative overflow-hidden rounded-2xl border border-border/50 bg-white p-8 shadow-sm transition-all duration-300 hover:shadow-lg dark:bg-darkmode-body">
                <!-- Timeline dot -->
                <div class="absolute -left-4 top-8 hidden h-8 w-8 rounded-full bg-primary shadow-lg lg:flex lg:items-center lg:justify-center">
                  <div class="h-4 w-4 rounded-full bg-white dark:bg-darkmode-light"></div>
                </div>
                
                <div class="lg:ml-8">
                  <div class="mb-6 flex flex-wrap items-start justify-between gap-4">
                    <div class="flex items-start gap-4">
                      <div class="flex-shrink-0">
                        <img 
                          src={exp.companyLogo} 
                          alt={exp.company}
                          class="w-12 h-12 object-contain rounded-lg bg-white dark:bg-darkmode-body p-2 shadow-sm border border-border/20 dark:border-darkmode-border/40"
                        />
                      </div>
                      <div>
                        <h3 class="text-xl font-bold text-dark dark:text-white mb-2">{exp.title}</h3>
                        <p class="text-lg font-semibold text-primary dark:text-darkmode-primary mb-1">{exp.company}</p>
                        <p class="text-sm text-text/70 dark:text-darkmode-text">{exp.location}</p>
                      </div>
                    </div>
                    <div class="text-right">
                      <span class="inline-block rounded-full bg-primary/10 px-4 py-2 text-sm font-medium text-primary">
                        {exp.period}
                      </span>
                    </div>
                  </div>
                  
                  <div class="mb-6">
                    <h4 class="mb-4 text-sm font-semibold uppercase tracking-wide text-text/70 dark:text-darkmode-text">Key Achievements</h4>
                    <ul class="space-y-2">
                      {exp.achievements.map((achievement) => (
                        <li class="flex items-start gap-3">
                          <div class="mt-2 h-1.5 w-1.5 rounded-full bg-primary flex-shrink-0"></div>
                          <span class="text-text/80 dark:text-darkmode-text">{achievement}</span>
                        </li>
                      ))}
                    </ul>
                  </div>
                  
                  <div>
                    <h4 class="mb-3 text-sm font-semibold uppercase tracking-wide text-text/70 dark:text-darkmode-text">Technologies Used</h4>
                    <div class="flex flex-wrap gap-2">
                      {exp.technologies.map((tech) => (
                        <span class="rounded-full bg-theme-light px-3 py-1 text-xs font-medium text-text/70 dark:bg-darkmode-light dark:text-darkmode-text">
                          {tech}
                        </span>
                      ))}
                    </div>
                  </div>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Skills Section -->
  <section class="section-sm bg-theme-light dark:bg-darkmode-theme-light">
    <div class="container">
      <div class="row">
        <div class="lg:col-12">
          <h2 class="h2 mb-8 text-center">Skills & Technologies</h2>
          <div class="grid grid-cols-3 md:grid-cols-5 lg:grid-cols-7 gap-6">
            {allSkills.map((skill) => (
              <div class="group flex flex-col items-center gap-3 p-4 rounded-2xl bg-white dark:bg-darkmode-body shadow-sm hover:shadow-md transition-all duration-300 hover:-translate-y-1">
                <div class="w-12 h-12 flex items-center justify-center">
                  <img 
                    src={skill.logo} 
                    alt={skill.name}
                    class="w-10 h-10 object-contain filter grayscale group-hover:grayscale-0 transition-all duration-300"
                  />
                </div>
                <span class="font-medium text-xs text-center text-text/70 group-hover:text-text dark:text-darkmode-text dark:group-hover:text-darkmode-text transition-colors duration-300">
                  {skill.name}
                </span>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Education Section -->
  <section class="section-sm">
    <div class="container">
      <div class="row justify-center">
        <div class="lg:col-8">
          <h2 class="h2 mb-8 text-center">Education</h2>
          <div class="rounded-2xl border border-border/50 bg-white p-8 shadow-sm dark:bg-darkmode-body">
            <div class="flex items-center gap-6">
              <div class="flex-shrink-0">
                <img 
                  src="/images/utc.png" 
                  alt="Universit√© de Technologie de Compi√®gne"
                  class="w-16 h-16 object-contain rounded-lg bg-white dark:bg-darkmode-body p-2 shadow-sm border border-border/20 dark:border-darkmode-border/40"
                />
              </div>
              <div class="flex-1">
                <h3 class="text-xl font-bold mb-2">Master of Science in Computer Science</h3>
                <p class="text-lg text-primary font-semibold mb-2">Universit√© de Technologie de Compi√®gne</p>
                <p class="text-text/70 dark:text-darkmode-text mb-2">Minor in Data Science and Machine Learning</p>
                <p class="text-sm text-text/60 dark:text-darkmode-text">Graduated 2019</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Personal Passions Section -->
  <section class="section-sm bg-theme-light dark:bg-darkmode-theme-light">
    <div class="container">
      <div class="row justify-center">
        <div class="lg:col-10">
          <h2 class="h2 mb-8 text-center">Beyond the Code</h2>
          <p class="text-center text-lg text-text/70 dark:text-darkmode-text mb-12 leading-relaxed">
            When I'm not building security tools, these passions keep me curious and creative
          </p>
          
          <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
            <!-- Running -->
            <div class="text-center group">
              <div class="w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-primary/10 to-secondary/10 rounded-2xl flex items-center justify-center group-hover:from-primary/20 group-hover:to-secondary/20 transition-all duration-300">
                <span class="text-3xl">üèÉ‚Äç‚ôÄÔ∏è</span>
              </div>
              <h3 class="h5 mb-3">Running</h3>
              <p class="text-text/70 dark:text-darkmode-text text-sm leading-relaxed">
                Long runs for mental clarity and endurance. Some of my best technical insights happen at mile 5.
              </p>
            </div>

            <!-- Ramen -->
            <div class="text-center group">
              <div class="w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-primary/10 to-secondary/10 rounded-2xl flex items-center justify-center group-hover:from-primary/20 group-hover:to-secondary/20 transition-all duration-300">
                <span class="text-3xl">üçú</span>
              </div>
              <h3 class="h5 mb-3">Ramen</h3>
              <p class="text-text/70 dark:text-darkmode-text text-sm leading-relaxed">
                Cooking and eating ramen is my meditation. The patience for good broth mirrors good code craftsmanship.
              </p>
            </div>

            <!-- D&D -->
            <div class="text-center group">
              <div class="w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-primary/10 to-secondary/10 rounded-2xl flex items-center justify-center group-hover:from-primary/20 group-hover:to-secondary/20 transition-all duration-300">
                <span class="text-3xl">üé≤</span>
              </div>
              <h3 class="h5 mb-3">D&D</h3>
              <p class="text-text/70 dark:text-darkmode-text text-sm leading-relaxed">
                Collaborative storytelling and creative problem-solving. Being a DM teaches you about creating engaging experiences.
              </p>
            </div>

            <!-- Wine -->
            <div class="text-center group">
              <div class="w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-primary/10 to-secondary/10 rounded-2xl flex items-center justify-center group-hover:from-primary/20 group-hover:to-secondary/20 transition-all duration-300">
                <span class="text-3xl">üç∑</span>
              </div>
              <h3 class="h5 mb-3">Wine</h3>
              <p class="text-text/70 dark:text-darkmode-text text-sm leading-relaxed">
                Understanding terroir‚Äîhow environment shapes outcomes. Like pairing engineers with the right opportunities.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact CTA -->
  <section class="section-sm bg-gradient-to-r from-primary/5 to-secondary/5">
    <div class="container">
      <div class="row justify-center">
        <div class="text-center lg:col-8">
          <h2 class="h2 mb-4">Let's Connect</h2>
          <p class="text-lg text-text/80 mb-8">
            I'm always interested in discussing new opportunities, sharing knowledge about AI security, 
            or connecting with fellow engineers and tech leaders.
          </p>
          <div class="flex flex-wrap justify-center gap-4">
            <a href="/contact" class="btn btn-primary">
              Get In Touch
            </a>
            <a href="mailto:emmanuelle.lejeail@gmail.com" class="btn btn-outline-primary">
              Send Email
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>
</Base>

<style>
  /* Timeline line for large screens */
  @media (min-width: 1024px) {
    .section .container .row .lg\\:col-12 > .space-y-8::before {
      content: '';
      position: absolute;
      left: -4px;
      top: 2rem;
      bottom: 2rem;
      width: 2px;
      background: linear-gradient(to bottom, #3b82f6, #8b5cf6);
      border-radius: 1px;
    }
    
    .section .container .row .lg\\:col-12 > .space-y-8 {
      position: relative;
    }
  }
</style>
